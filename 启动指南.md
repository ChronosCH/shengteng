# 增强版CE-CSL手语识别系统启动指南

## 系统架构

本系统包含以下组件：
- 后端服务：基于FastAPI的简化版CE-CSL服务 (端口: 8001)
- 前端服务：基于React + Vite的用户界面 (端口: 5173)  
- 增强版CE-CSL模型：训练好的手语识别模型

## 快速启动

### 自动启动 (推荐)
```bash
# Windows用户
双击运行: start_enhanced_server.bat

# 或手动执行
start_enhanced_server.bat
```

### 手动启动

#### 1. 启动后端服务
```bash
# 打开第一个终端
cd d:\shengteng\backend
conda activate shengteng
python main_simple.py

# 或使用uvicorn
uvicorn main_simple:app --host 0.0.0.0 --port 8001 --reload
```

#### 2. 启动前端服务  
```bash
# 打开第二个终端
cd d:\shengteng\frontend
conda activate shengteng  # 如果需要
npm run dev
```

## 验证服务状态

### 后端服务检查
访问以下URL验证后端是否正常运行：
- 基础信息: http://localhost:8001
- 健康检查: http://localhost:8001/api/health
- 统计信息: http://localhost:8001/api/enhanced-cecsl/stats

### 前端服务检查
- 前端页面: http://localhost:5173

## 使用增强版视频识别功能

### 1. 访问前端页面
在浏览器中打开: http://localhost:5173

### 2. 进入识别页面
点击"实时手语识别"或导航到识别功能页面

### 3. 使用增强版视频识别
- 查找"增强版CE-CSL视频识别"组件
- 上传手语视频文件 (支持: MP4, AVI, MOV, MKV, WEBM)
- 文件大小限制: 100MB
- 等待处理完成
- 查看识别结果

### 4. 功能特性
- **拖拽上传**: 支持拖拽文件到上传区域
- **进度显示**: 实时显示上传和处理进度
- **结果展示**: 显示识别文本、置信度、手语序列
- **错误处理**: 友好的错误提示和重试机制

## API接口文档

### 基础接口
```http
GET  /                              # 服务信息
GET  /api/health                    # 健康检查
GET  /api/enhanced-cecsl/stats      # 统计信息
```

### 增强版CE-CSL接口
```http
POST /api/enhanced-cecsl/test                   # 测试模型
POST /api/enhanced-cecsl/upload-video          # 上传视频
GET  /api/enhanced-cecsl/video-status/{task_id} # 查询状态
```

### 使用示例

#### 测试模型预测
```bash
curl -X POST "http://localhost:8001/api/enhanced-cecsl/test" \
  -H "Content-Type: application/json" \
  -d '{
    "landmarks": [[0.1, 0.2, 0.3], [0.4, 0.5, 0.6]],
    "description": "测试请求"
  }'
```

#### 上传视频文件
```bash
curl -X POST "http://localhost:8001/api/enhanced-cecsl/upload-video" \
  -F "file=@test_video.mp4"
```

## 目录结构

```
d:\shengteng\
├── backend/
│   ├── main_simple.py          # 简化版后端主文件
│   ├── uploads/                # 上传文件目录
│   └── ...
├── frontend/
│   ├── src/
│   │   ├── components/
│   │   │   └── EnhancedVideoRecognition.tsx
│   │   ├── services/
│   │   │   └── enhancedCECSLService.ts
│   │   └── pages/
│   │       └── RecognitionPage.tsx
│   ├── .env                    # 环境配置
│   └── package.json
├── training/
│   └── output/
│       ├── enhanced_cecsl_final_model.ckpt
│       └── enhanced_vocab.json
└── start_enhanced_server.bat   # 启动脚本
```

## 环境要求

### Python环境
- Python 3.11+
- conda环境: shengteng
- 依赖包: fastapi, uvicorn, numpy, pydantic

### Node.js环境  
- Node.js 18+
- npm 8+
- 依赖包: react, typescript, vite, @mui/material

### 系统要求
- Windows 10/11
- 内存: 4GB+
- 存储: 2GB+ 可用空间

## 故障排除

### 常见问题

#### 1. 后端启动失败
```bash
# 检查依赖
cd backend
python -c "import fastapi, uvicorn, numpy, pydantic"

# 重新安装依赖
pip install fastapi uvicorn numpy pydantic python-multipart
```

#### 2. 前端启动失败
```bash
# 检查Node.js版本
node --version
npm --version

# 重新安装依赖
cd frontend
npm install
```

#### 3. 端口冲突
```bash
# 检查端口占用
netstat -an | findstr "8001"
netstat -an | findstr "5173"

# 修改端口
# 后端: 编辑 main_simple.py 中的端口号
# 前端: 编辑 vite.config.ts 中的端口号
```

#### 4. 跨域问题
- 后端已配置CORS允许所有源
- 确保前端.env文件中API地址正确

#### 5. 视频上传失败
- 检查文件格式是否支持
- 确认文件大小不超过100MB
- 验证后端uploads目录权限

### 日志查看
```bash
# 后端日志：在启动后端的终端窗口查看
# 前端日志：在浏览器开发者工具Console中查看
```

## 开发调试

### 后端调试
```bash
cd backend
python -m debugpy --listen 5678 main_simple.py
```

### 前端调试
```bash
cd frontend  
npm run dev
# 在浏览器中按F12打开开发者工具
```

### API测试
```bash
# 使用Postman或curl测试API接口
# 健康检查
curl http://localhost:8001/api/health
```

## 性能优化

### 后端优化
- 当前使用模拟模式，响应速度快
- 可集成真实MindSpore模型提高准确性
- 支持异步处理，可处理并发请求

### 前端优化  
- 使用Vite构建，支持热更新
- 组件懒加载，减少初始加载时间
- Material-UI优化用户体验

## 下一步计划

1. **模型集成**: 集成真实的MindSpore推理
2. **关键点提取**: 添加MediaPipe视频处理
3. **用户认证**: 添加用户登录和权限管理
4. **数据持久化**: 添加数据库存储
5. **生产部署**: 配置Docker和反向代理

---

**🎉 享受手语识别的强大功能！**

如有问题，请检查：
1. conda环境是否正确激活
2. 依赖包是否完整安装  
3. 端口是否被其他程序占用
4. 防火墙是否阻止访问
